; File generated with Shader Minifier 1.1.4
; http://www.ctrl-alt-test.fr

_main_shader_glsl:
	db 'vec3 v=vec3(vec2(0.,0.),v[0]);'
	db 'float y=v.z;'
	db 'uniform sampler2D S;'
	db 'vec3 m=vec3(0.,.01,1.);'
	db 'vec4 f(vec2 y)'
	db '{'
	db   'return texture2D(S,(y+.5)/textureSize(S,0));'
	db '}'
	db 'const float z=6.36e+06,x=6.38e+06,w=1000.,e=2500.,s=500.,n=.76,d=n*n,t=8000.,l=1200.;'
	db 'float i=10.;'
	db 'const vec3 a=vec3(0.,-z,0.),p=vec3(5.8e-06,1.35e-05,3.31e-05),r=vec3(2e-05),o=r*1.1;'
	db 'vec3 c=vec3(1.,.01,1.);'
	db 'float h(vec3 v)'
	db '{'
	db   'return(f(v.xz).x+f(v.yx).y)*.5;'
	db '}'
	db 'bool g=true;'
	db 'vec2 D(vec3 v)'
	db '{'
	db   'float x=max(0.,length(v-a)-z);'
	db   'vec2 f=vec2(exp(-x/t),exp(-x/l)*8.);'
	db   'if(g&&w<x&&x<e)'
	db     '{'
	db       'vec3 m=.0015*(v+y*vec3(-90.,0.,80.));'
	db       'f.y+=250.*step(m.z,38.)*smoothstep(w,w+100.,x)*smoothstep(e,e-1000.,x)*smoothstep(.5,.55,.75*h(m)+.125*h(m*4.3+max(y,144.))+.0625*h(m*9.9)+.0625*h(m*17.8)-.1);'
	db     '}'
	db   'return f;'
	db '}'
	db 'float D(vec3 v,vec3 y,float x)'
	db '{'
	db   'vec3 m=v-a;'
	db   'float f=dot(m,y),c=dot(m,m)-x*x,z=f*f-c;'
	db   'if(z<0.)'
	db     'return-1.;'
	db   'float N=sqrt(z),V=-f-N,e=-f+N;'
	db   'return V>=0.?V:e;'
	db '}'
	db 'vec4 u;'
	db 'vec2 D(vec3 v,vec3 f,float m,float y)'
	db '{'
	db   'vec2 z=vec2(0.);'
	db   'm/=y;'
	db   'f*=m;'
	db   'for(float x=u.w*.5;x<y;++x)'
	db     'z+=D(v+f*x);'
	db   'return z*m;'
	db '}'
	db 'vec3 f(vec3 v,vec3 m,float y)'
	db '{'
	db   'vec2 T=D(v,m,y,32.);'
	db   'return exp(-p*T.x-o*T.y);'
	db '}'
	db 'vec2 C;'
	db 'vec3 b,q;'
	db 'void f(vec3 v,vec3 f,float m,float y)'
	db '{'
	db   'm/=y;'
	db   'f*=m;'
	db   'for(float i=u.z;i<y;++i)'
	db     '{'
	db       'vec3 M=v+f*i;'
	db       'vec2 T=D(M)*m;'
	db       'C+=T;'
	db       'vec2 s=C;'
	db       'float N=max(0.,D(M,c,z+e));'
	db       'if(N>0.)'
	db         's+=D(M,c,N,16.);'
	db       's+=D(M+c*N,c,D(M,c,x),4.);'
	db       'vec3 n=exp(-p*s.x-o*s.y);'
	db       'b+=n*T.x;'
	db       'q+=n*T.y;'
	db     '}'
	db '}'
	db 'vec3 h(vec3 v,vec3 m,float y,vec3 x)'
	db '{'
	db   'C=vec2(0.);'
	db   'b=q=vec3(0.);'
	db   'float N=D(v,m,z+w);'
	db   'if(y<N)'
	db     'f(v,m,y,16.);'
	db   'else'
	db     '{'
	db       'float s=D(v,m,z+e);'
	db       'f(v,m,N,16.);'
	db       'f(v+m*N,m,s-N,40.);'
	db       'f(v+m*s,m,y-s,8.);'
	db     '}'
	db   'float s=dot(m,c);'
	db   'return x*exp(-p*C.x-o*C.y)+i*(1.+s*s)*(b*p*.0596831+q*r*.119366*(1.-d)/((2.+d)*pow(1.+d-2.*n*s,1.5)));'
	db '}'
	db 'float Z(vec3 v)'
	db '{'
	db   'return max(v.x,max(v.y,v.z));'
	db '}'
	db 'float Y(vec2 v)'
	db '{'
	db   'return max(v.x,v.y);'
	db '}'
	db 'float X(vec2 v)'
	db '{'
	db   'return min(v.x,v.y);'
	db '}'
	db 'vec2 D(vec2 v,vec2 y)'
	db '{'
	db   'return mod(v,y)-y*.5;'
	db '}'
	db 'float W=0.;'
	db 'vec2 V=vec2(0.);'
	db 'const float U=4.;'
	db 'vec4 T,R;'
	db 'float Q(vec3 v)'
	db '{'
	db   'vec2 m=normalize(vec2(-1.,2.));'
	db   'float y=12.-abs(dot(m,v.xz)),x=dot(vec2(m.y,-m.x),v.xz),M=length(v.xz);'
	db   'W=1.;'
	db   'if(M>5000.)'
	db     'return v.y-min(1.,(M-5000.)/500.)*400.*f(v.xz/300.).x;'
	db   'float z=v.y;'
	db   'vec2 N=floor(v.xz/30.);'
	db   'v.xz=D(v.xz,vec2(30.));'
	db   'T=f(N);'
	db   'R=f(N/8.);'
	db   'vec3 c=vec3(abs(v.xz)-15.,y),O=vec3(c+U);'
	db   'float s=min(Y(c.xy),-c.z),e=3.*floor(2.+T.w*4.+20.*smoothstep(.8,.99,T.w)*smoothstep(.6,.9,R.w)),n=min(min(max(Z(O.xyz+T.xyz*4.),v.y-e),max(Z(O.xyz+T.zxw*7.),v.y-e-3.*floor(T.w*4.))),max(Z(O.yzx+10.*T.xyz),v.y-e+3.*floor(T.y*2.)));'
	db   'V=mix(vec2(Y(c.xy)+U,X(c.xy)),vec2(c.z,x),step(0.,c.z));'
	db   'if(n<z)'
	db     'z=n,W=0.,V=c.xy;'
	db   'return max(v.y-90.,min(z,-s+U));'
	db '}'
	db 'float P;'
	db 'vec3 O,N,M,L;'
	db 'void K(float y)'
	db '{'
	db   'for(int f=0;f<800;++f)'
	db     '{'
	db       'M=O+N*P;'
	db       'float m=Q(M);'
	db       'P+=m;'
	db       'if(m<P/v.x||P>y)'
	db         'return;'
	db     '}'
	db   'P=y;'
	db '}'
	db 'float J,I;'
	db 'float H(vec3 v)'
	db '{'
	db   'return mix(max(0.,dot(L,v))/3.,pow(max(0.,dot(L,normalize(v-N))),I)*(I+8.)/24.,J);'
	db '}'
	db 'float G(vec3 v)'
	db '{'
	db   'return v-=M,H(normalize(v))/dot(v,v);'
	db '}'
	db 'void main()'
	db '{'
	db   'u=f(gl_FragCoord.xy+y*10000.);'
	db   'vec3 z=vec3(0.);'
	db   'O=vec3(-300.,200.,mod(y,64.)*4.);'
	db   'if(y<32.)'
	db     'z=vec3(0.,340.,200.);'
	db   'else'
	db     ' if(y<64.)'
	db       '{'
	db         'float s=(y-64.)/64.;'
	db         'O=vec3(s*100.,250.,-36.);'
	db         'z=O+vec3(-30.,0.,-30.);'
	db         'z.y=10.;'
	db         'c.y+=.01*s*s*s;'
	db       '}'
	db     'else'
	db       ' if(y<128.)'
	db         ';'
	db       'else'
	db         ' if(y<144.)'
	db           'z=vec3(O.x+9.,90.,O.z+20.),O.y=100.;'
	db         'else'
	db           '{'
	db             'float s=(y-144.)/64.;'
	db             'z=vec3(500.,smoothstep(204.,232.,y)*800.,200.);'
	db             'O=vec3(-400+s*100.,230.-s*10.,-130.-s*140.);'
	db             'c.y=.01+s*1.5;'
	db           '}'
	db   'c=normalize(c);'
	db   'N=normalize(O-z);'
	db   'vec3 s=normalize(cross(m.xzx,N));'
	db   'N=mat3(s,normalize(cross(N,s)),N)*normalize(vec3((gl_FragCoord.xy+u.xy)/v.xy*2.-1.,-2.)*vec3(v.x/v.y,1.,1.));'
	db   'vec3 e=vec3(0.);'
	db   'const float w=10000.;'
	db   'K(w);'
	db   'if(P<w)'
	db     '{'
	db       'L=normalize(vec3(Q(M+m.yxx),Q(M+m.xyx),Q(M+m.xxy))-Q(M));'
	db       'vec2 n=vec2(Y(-V),M.y),d=mod(n,vec2(3.)),p=floor(n/3.);'
	db       'float r=step(1.3,d.y)*step(.8,d.x);'
	db       'vec3 t=mix(vec3(.1)+.02*T.yzw,vec3(.2),r)*(.1+.9*smoothstep(0.,24.,M.y));'
	db       'J=mix(.3,.9,r);'
	db       'I=mix(18.,10000.,r);'
	db       'if(W>0.)'
	db         'r=0.,J=.2,I=80.,t=mix(vec3(.3)*(.1+.3*smoothstep(-2.,1.,V.x)),vec3(.01+.9*step(3.9,mod(V.x,4.)*step(.5,fract(V.y/4.)))),step(1.,V.x));'
	db       'e+=f(M,c,D(M,c,x))*i*H(c);'
	db       'vec2 a=floor((M.xz+15.)/30.);'
	db       'e+=250.*mix(vec3(.9,.5,.2),vec3(.2,.5,.9),T.z*.5)*T.w*G(vec3(30.*(a+(f(a).xy-.5)),3.).xzy)*smoothstep(144.,140.,y-T.w*4.-R.w*8.);'
	db       'vec3 U=vec3(-c.x,c.y,-c.z);'
	db       'g=false;'
	db       'e+=h(M,U,D(M,U,x),vec3(0.))*6.*H(U);'
	db       'g=true;'
	db       'e=h(O,N,P,e*t);'
	db       'vec4 C=f(floor(p+M.xz/3.));'
	db       'e+=r*vec3(.2+.2*C.xyz)*smoothstep(.85,1.,C.w+.1*smoothstep(.34,.8,.2*T.w+.8*R.w)-max(0.,y-136.)/64.);'
	db     '}'
	db   'else'
	db     ' e=h(O,N,D(O,N,x),vec3(0.));'
	db   'gl_FragColor=vec4(pow(smoothstep(0.,32.,y)*e,vec3(1./2.2)),.3);'
	db '}', 0

