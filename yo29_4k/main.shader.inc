; File generated with Shader Minifier 1.1.4
; http://www.ctrl-alt-test.fr

_main_shader_glsl:
	db 'float v=F[0];'
	db 'uniform sampler2D S;'
	db 'vec3 m=vec3(0.,.01,1.);'
	db 'vec4 f(vec2 v)'
	db '{'
	db   'return texture2D(S,(v+.5)/textureSize(S,0));'
	db '}'
	db 'const float y=6.36e+06,z=6.38e+06,x=2000.,e=4000.,n=1000.,s=.76,w=s*s,i=8000.,r=1200.;'
	db 'float t=10.;'
	db 'const vec3 a=vec3(0.,-y,0.),d=vec3(5.8e-06,1.35e-05,3.31e-05),p=vec3(2e-05),l=p*1.1;'
	db 'vec3 c=vec3(1.,.001,1.);'
	db 'float h(vec3 v)'
	db '{'
	db   'return mix(f(v.xz).x,f(v.yx).y,.5);'
	db '}'
	db 'float g(vec3 v)'
	db '{'
	db   'return.75*h(v)+.125*h(v*4.3);'
	db '}'
	db 'float D(vec3 v)'
	db '{'
	db   'float f=g(v*.001);'
	db   'f=smoothstep(.49,.5,f);'
	db   'return f;'
	db '}'
	db 'bool u=true;'
	db 'vec2 o(vec3 m)'
	db '{'
	db   'float z=max(0.,length(m-a)-y);'
	db   'vec2 c=vec2(exp(-z/i),exp(-z/r)*4.);'
	db   'if(u)'
	db     '{'
	db       'if(x<z&&z<e)'
	db         'c.y+=50.*step(length(m),50000.)*smoothstep(x,x+n,z)*smoothstep(e,e-n,z)*D(m+vec3(0.,0.,v*80.));'
	db     '}'
	db   'return c;'
	db '}'
	db 'float D(vec3 v,vec3 z,float y)'
	db '{'
	db   'vec3 m=v-a;'
	db   'float s=dot(m,z),c=dot(m,m)-y*y,f=s*s-c;'
	db   'if(f<0.)'
	db     'return-1.;'
	db   'float x=sqrt(f),R=-s-x,e=-s+x;'
	db   'return R>=0.?R:e;'
	db '}'
	db 'vec2 D(vec3 v,vec3 f,float m,float y)'
	db '{'
	db   'vec2 z=vec2(0.);'
	db   'm/=y;'
	db   'f*=m;'
	db   'for(float s=0.;s<y;++s)'
	db     'z+=o(v+f*s);'
	db   'return z*m;'
	db '}'
	db 'vec3 f(vec3 v,vec3 m,float z)'
	db '{'
	db   'vec2 s=D(v,m,z,32.);'
	db   'return exp(-(d*s.x+l*s.y));'
	db '}'
	db 'void D(vec3 v,vec3 f,float m,float x,inout vec2 T,inout vec3 i,inout vec3 r)'
	db '{'
	db   'm/=x;'
	db   'f*=m;'
	db   'for(float s=0.;s<x;++s)'
	db     '{'
	db       'vec3 Q=v+f*s;'
	db       'vec2 n=o(Q)*m;'
	db       'T+=n;'
	db       'vec2 Y=T;'
	db       'float R=D(Q,c,y+e);'
	db       'if(R>0.)'
	db         'Y+=D(Q,c,R,16.);'
	db       'else'
	db         ' R=0.;'
	db       'Y+=D(Q+c*R,c,D(Q,c,z),4.);'
	db       'vec3 t=exp(-(d*Y.x+l*Y.y));'
	db       'i+=t*n.x;'
	db       'r+=t*n.y;'
	db     '}'
	db '}'
	db 'vec3 f(vec3 v,vec3 m,float f,vec3 z)'
	db '{'
	db   'vec2 R=vec2(0.);'
	db   'vec3 Q=vec3(0.),n=vec3(0.);'
	db   'float Y=D(v,m,y+x);'
	db   'if(f<Y)'
	db     'D(v,m,f,16.,R,Q,n);'
	db   'else'
	db     '{'
	db       'float T=D(v,m,y+e);'
	db       'D(v,m,Y,32.,R,Q,n);'
	db       'D(v+m*Y,m,T-Y,32.,R,Q,n);'
	db       'D(v+m*T,m,f-T,8.,R,Q,n);'
	db     '}'
	db   'float T=dot(m,c);'
	db   'return z*exp(-(d*R.x+l*R.y))+t*(1.+T*T)*(Q*d*.0596831+n*p*.119366*(1.-w)/((2.+w)*pow(1.+w-2.*s*T,1.5)));'
	db '}'
	db 'float C(vec3 v)'
	db '{'
	db   'return max(v.x,max(v.y,v.z));'
	db '}'
	db 'float b(vec2 v)'
	db '{'
	db   'return max(v.x,v.y);'
	db '}'
	db 'float q(vec2 v)'
	db '{'
	db   'return min(v.x,v.y);'
	db '}'
	db 'vec2 C(vec2 v,vec2 z)'
	db '{'
	db   'return mod(v,z)-z*.5;'
	db '}'
	db 'float Z=0.;'
	db 'vec2 Y=vec2(0.);'
	db 'float X=0.;'
	db 'const float W=4.;'
	db 'float D(vec4 v,vec2 m)'
	db '{'
	db   'vec4 s=f(m),c=f(m/8.);'
	db   'float z=3.*(2.+floor(s.w*7.+20.*smoothstep(.8,.99,s.w)*smoothstep(.6,.9,c.w)));'
	db   'return min(min(max(C(v.xyz+s.xyz*4.),v.w-z),max(C(v.xyz+s.xyz*7.),v.w-z-3.*floor(s.z*4.))),max(C(v.yzx+10.*s.xyz),v.w-z+3.*floor(s.y*2.)));'
	db '}'
	db 'float V(vec3 v)'
	db '{'
	db   'vec2 m=normalize(vec2(-1.,2.));'
	db   'float z=12.-abs(dot(m,v.xz)),y=dot(vec2(m.y,-m.x),v.xz);'
	db   'vec2 f=floor(v.xz/30.);'
	db   'v.xz=C(v.xz,vec2(30.));'
	db   'vec3 s=vec3(abs(v.xz)-15.,z);'
	db   'float T=min(b(s.xy),-s.z),Q=D(vec4(s+W,v.y),f);'
	db   'Y=mix(vec2(b(s.xy)+W,q(s.xy)),vec2(s.z,y),step(0.,s.z));'
	db   'float R=v.y;'
	db   'Z=1.;'
	db   'if(Q<R)'
	db     'R=Q,Z=0.,Y=s.xy;'
	db   'return min(R,-T+W);'
	db '}'
	db 'float U;'
	db 'vec3 T,R,Q;'
	db 'void P(float v)'
	db '{'
	db   'for(int f=0;f<800;++f)'
	db     '{'
	db       'Q=T+R*U;'
	db       'float m=V(Q);'
	db       'U+=m;'
	db       'if(m<.0003*U||U>v)'
	db         'return;'
	db     '}'
	db   'U=v;'
	db '}'
	db 'void main()'
	db '{'
	db   'const vec2 s=vec2(640.,360.);'
	db   'vec2 x=gl_FragCoord.xy/s*2.-1.;'
	db   'x.x*=s.x/s.y;'
	db   'if(gl_FragCoord.y<10.)'
	db     '{'
	db       'gl_FragColor=vec4(step(gl_FragCoord.x/s.x,v/208.));'
	db       'return;'
	db     '}'
	db   'vec3 y,n=vec3(0.);'
	db   'T=vec3(mod(v*2.,10000.)-5000.,1000.+500.*sin(v/60.),mod(v*10.,10000.)-5000.);'
	db   'if(v<64.)'
	db     't=10.*v/64.,n=vec3(10000.,15000.,-10000.);'
	db   'else'
	db     ' if(v<128.)'
	db       '{'
	db         'T.y=1000.;'
	db         'float d=(v-64.)/64.;'
	db         'T=vec3(d*1000.,1500.,3000.);'
	db         'n=T+vec3(-300.,0.,-300.);'
	db         'n.y=10.;'
	db         'c.y+=.01*d*d*d;'
	db       '}'
	db     'else'
	db       ' if(v<144.)'
	db         'c.y=.01;'
	db       'else'
	db         '{'
	db           'float d=(v-144.)/64.;'
	db           'T=vec3(mod(d*2.,10000.)-500.,1000.-200.*d,mod(d*10.,10000.)-5000.);'
	db           'n.y=4000.*d;'
	db           'c.y=.01+2.*d;'
	db         '}'
	db   'c=normalize(c);'
	db   'R=normalize(T-n);'
	db   'T=vec3(-1.,4.,8.)*10.;'
	db   'R=-normalize(vec3(.7,-.17,.67));'
	db   'vec3 d=normalize(cross(m.xzx,R));'
	db   'R=mat3(d,normalize(cross(R,d)),R)*normalize(vec3(x,-2.));'
	db   'vec3 i=vec3(0.);'
	db   'const float e=10000.;'
	db   'P(e);'
	db   'float r=.3,w=10.;'
	db   'if(U<e)'
	db     '{'
	db       'y=normalize(vec3(V(Q+m.yxx),V(Q+m.xyx),V(Q+m.xxy))-V(Q));'
	db       'float C=max(-Y.x,-Y.y),p=mod(Q.y,3.),l=floor(C/2.),a=floor(Q.y/3.),W=mod(C,2.),q=step(1.,p)*step(p,2.5)*step(.1,W)*step(W,1.9);'
	db       'vec3 h=vec3(mix(.1,.6,q));'
	db       'r=mix(.3,.7,q);'
	db       'w=mix(80.,10000.,q);'
	db       'if(Z>0.)'
	db         'q=0.,r=.2,w=80.,h=mix(vec3(.3),vec3(.01+.9*step(3.9,mod(Y.x,4.)*step(.5,fract(Y.y/4.)))),step(1.,Y.x));'
	db       'i=f(Q,c,D(Q,c,z))*t*mix(max(0.,dot(y,c))/3.,max(0.,pow(dot(y,normalize(c-R)),w)*(w+8.)/24.),r);'
	db       'vec3 X=vec3(-c.x,c.y,-c.z);'
	db       'u=false;'
	db       'i+=f(Q,X,D(Q,X,z),vec3(0.))*r*max(0.,dot(y,X));'
	db       'u=true;'
	db       'i=f(T,R,U,i*h);'
	db     '}'
	db   'else'
	db     ' i=f(T,R,D(T,R,z),vec3(0.));'
	db   'gl_FragColor=vec4(pow(i,vec3(1./2.2)),.5);'
	db '}', 0

